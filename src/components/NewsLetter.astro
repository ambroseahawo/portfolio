<div class="cg3vi cj965 cry3b c81t6 cax03 c1gvt czh94 czz51 c90wr c5oxi">
  <div class="c41ht c0kco">
    <div class="cz5kb c2e3l cmrd7">
      {
        Array.from({ length: 5 }, (_, i) => (
          <img
            class="cg3vi c3iz2 crjg4 c6nlo cywxr"
            src={`/images/avatar-${String(i + 1).padStart(2, "0")}.jpg`}
            width="24"
            height="24"
            alt={`Avatar ${i + 1}`}
          />
        ))
      }
    </div>
  </div>
  <div class="c41ht cpl46">
    <div class="cpynq c670g c0kco">Never miss an update!</div>
    <p class="cxslc c2bb0 cme8e">Subscribe and join other developers.</p>
  </div>
  <form id="newsletter-form" class="newsletter-form">
    <div class="c4udf">
      <label class="c4g5b" for="newsletter"> Your email… </label>
      <input
        id="newsletter"
        type="email"
        class="c899y c8pgj cfi31"
        placeholder="Your email…"
        required
      />
    </div>
    <button class="cwlj7 c0kjz czzu3 csfon c8pgj" type="submit">
      Subscribe
    </button>
  </form>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("newsletter-form")
    if (form) {
      form.addEventListener("submit", async (e: SubmitEvent) => {
        e.preventDefault()
        const form = e.target as HTMLFormElement
        const email = (
          form.elements.namedItem("newsletter") as HTMLInputElement
        ).value
        const submitButton = form.querySelector(
          'button[type="submit"]'
        ) as HTMLButtonElement

        // Disable the submit button and show loading state
        submitButton.disabled = true
        submitButton.textContent = "Subscribing..."

        try {
          const res = await fetch("/api/subscribe", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              email: email,
            }),
          })

          if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`)
          }

          const result = await res.json()

          // Show success message
          console.log("Thank you for subscribing!")
          form.reset()
        } catch (error) {
          // Show error message
          console.log(
            "Sorry, there was an error subscribing. Please try again later."
          )
          console.error("Subscription error:", error)
        } finally {
          // Re-enable the submit button
          submitButton.disabled = false
        }
      })
    }
  })
</script>
